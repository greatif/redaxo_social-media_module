<?php
$userid = substr(REX_VALUE[1], 0, 10);
$url = 'https://api.instagram.com/v1/users/'.$userid.'/media/recent/?access_token=REX_VALUE[1]';
$output = '';
$counter = 0;

// Get cURL resource
$curl = curl_init();
// Options
curl_setopt_array($curl, array(
  CURLOPT_RETURNTRANSFER => 1,
  CURLOPT_URL => $url,
  CURLOPT_TIMEOUT => 4
 ));
// Send the request & save response to $resp
$resp = curl_exec($curl);
curl_close($curl);

if($resp){
	$output .= '
		<div class="row">
			<hr /><h2 class="text-center title-uppercase">Instagram</h2><br>';
	
	$data=json_decode($resp, true);
	foreach((array)$data['data'] as $images){
		if ($counter < REX_VALUE[2]) {
			$output .= '
				<div class="text-center col-md-2 col-sm-3 col-xs-6 instagram">
					<a href="'.$images['link'].'" ><img src="'.$images['images']['thumbnail']['url'].'" alt="'.$images['id'].'"/><p><i class="fa fa-heart"></i> '.$images['likes']['count'].' | <i class="fa fa-comment"></i> '.$images['comments']['count'].'</p></a>
				</div>';
			$counter++;
		}
	}

	$output .= '
		</div>';
		
	echo $output;
	
}
else echo "FEHLER";

?>
